var _origin = [{"name":"Audi","value":24748,"x":"2019-07-29"},{"name":"Audi","value":25372,"x":"2019-07-30"},{"name":"Audi","value":28262,"x":"2019-07-31"},{"name":"Audi","value":24909,"x":"2019-08-01"},{"name":"Audi","value":21716,"x":"2019-08-02"},{"name":"Audi","value":19822,"x":"2019-08-03"},{"name":"Audi","value":19214,"x":"2019-08-04"},{"name":"Audi","value":21484,"x":"2019-08-05"},{"name":"Audi","value":21472,"x":"2019-08-06"},{"name":"Audi","value":21628,"x":"2019-08-07"},{"name":"Audi","value":21912,"x":"2019-08-08"},{"name":"Audi","value":24198,"x":"2019-08-09"},{"name":"Audi","value":20488,"x":"2019-08-10"},{"name":"Audi","value":20066,"x":"2019-08-11"},{"name":"Audi","value":23413,"x":"2019-08-12"},{"name":"Audi","value":25832,"x":"2019-08-13"},{"name":"Audi","value":27265,"x":"2019-08-14"},{"name":"Audi","value":24554,"x":"2019-08-15"},{"name":"Audi","value":24223,"x":"2019-08-16"},{"name":"Audi","value":22111,"x":"2019-08-17"},{"name":"Audi","value":21560,"x":"2019-08-18"},{"name":"Audi","value":34278,"x":"2019-08-19"},{"name":"Audi","value":34710,"x":"2019-08-20"},{"name":"Audi","value":37187,"x":"2019-08-21"},{"name":"Audi","value":28606,"x":"2019-08-22"},{"name":"Audi","value":29849,"x":"2019-08-23"},{"name":"Audi","value":25503,"x":"2019-08-24"},{"name":"Audi","value":26128,"x":"2019-08-25"},{"name":"Audi","value":77896,"x":"2019-08-26"},{"name":"Audi","value":71553,"x":"2019-08-27"},{"name":"Audi","value":48260,"x":"2019-08-28"},{"name":"Audi","value":50882,"x":"2019-08-29"},{"name":"BMW","value":37906,"x":"2019-07-29"},{"name":"BMW","value":42483,"x":"2019-07-30"},{"name":"BMW","value":39601,"x":"2019-07-31"},{"name":"BMW","value":37549,"x":"2019-08-01"},{"name":"BMW","value":36870,"x":"2019-08-02"},{"name":"BMW","value":32245,"x":"2019-08-03"},{"name":"BMW","value":31585,"x":"2019-08-04"},{"name":"BMW","value":40358,"x":"2019-08-05"},{"name":"BMW","value":63023,"x":"2019-08-06"},{"name":"BMW","value":35006,"x":"2019-08-07"},{"name":"BMW","value":34769,"x":"2019-08-08"},{"name":"BMW","value":35280,"x":"2019-08-09"},{"name":"BMW","value":31824,"x":"2019-08-10"},{"name":"BMW","value":31123,"x":"2019-08-11"},{"name":"BMW","value":37532,"x":"2019-08-12"},{"name":"BMW","value":40573,"x":"2019-08-13"},{"name":"BMW","value":41860,"x":"2019-08-14"},{"name":"BMW","value":39409,"x":"2019-08-15"},{"name":"BMW","value":35495,"x":"2019-08-16"},{"name":"BMW","value":31724,"x":"2019-08-17"},{"name":"BMW","value":31598,"x":"2019-08-18"},{"name":"BMW","value":43737,"x":"2019-08-19"},{"name":"BMW","value":45367,"x":"2019-08-20"},{"name":"BMW","value":42111,"x":"2019-08-21"},{"name":"BMW","value":41933,"x":"2019-08-22"},{"name":"BMW","value":40739,"x":"2019-08-23"},{"name":"BMW","value":39508,"x":"2019-08-24"},{"name":"BMW","value":39255,"x":"2019-08-25"},{"name":"BMW","value":43263,"x":"2019-08-26"},{"name":"BMW","value":45463,"x":"2019-08-27"},{"name":"BMW","value":46212,"x":"2019-08-28"},{"name":"BMW","value":45891,"x":"2019-08-29"},{"name":"Infiniti","value":2312,"x":"2019-07-29"},{"name":"Infiniti","value":2557,"x":"2019-07-30"},{"name":"Infiniti","value":2971,"x":"2019-07-31"},{"name":"Infiniti","value":2848,"x":"2019-08-01"},{"name":"Infiniti","value":2812,"x":"2019-08-02"},{"name":"Infiniti","value":2093,"x":"2019-08-03"},{"name":"Infiniti","value":2359,"x":"2019-08-04"},{"name":"Infiniti","value":4132,"x":"2019-08-05"},{"name":"Infiniti","value":4670,"x":"2019-08-06"},{"name":"Infiniti","value":3046,"x":"2019-08-07"},{"name":"Infiniti","value":3646,"x":"2019-08-08"},{"name":"Infiniti","value":2633,"x":"2019-08-09"},{"name":"Infiniti","value":1917,"x":"2019-08-10"},{"name":"Infiniti","value":1731,"x":"2019-08-11"},{"name":"Infiniti","value":3304,"x":"2019-08-12"},{"name":"Infiniti","value":2894,"x":"2019-08-13"},{"name":"Infiniti","value":4447,"x":"2019-08-14"},{"name":"Infiniti","value":4288,"x":"2019-08-15"},{"name":"Infiniti","value":2906,"x":"2019-08-16"},{"name":"Infiniti","value":2676,"x":"2019-08-17"},{"name":"Infiniti","value":3038,"x":"2019-08-18"},{"name":"Infiniti","value":5015,"x":"2019-08-19"},{"name":"Infiniti","value":4300,"x":"2019-08-20"},{"name":"Infiniti","value":3425,"x":"2019-08-21"},{"name":"Infiniti","value":3317,"x":"2019-08-22"},{"name":"Infiniti","value":3379,"x":"2019-08-23"},{"name":"Infiniti","value":4086,"x":"2019-08-24"},{"name":"Infiniti","value":2359,"x":"2019-08-25"},{"name":"Infiniti","value":3879,"x":"2019-08-26"},{"name":"Infiniti","value":3694,"x":"2019-08-27"},{"name":"Infiniti","value":3430,"x":"2019-08-28"},{"name":"Infiniti","value":3705,"x":"2019-08-29"},{"name":"Jaguar","value":3517,"x":"2019-07-29"},{"name":"Jaguar","value":2950,"x":"2019-07-30"},{"name":"Jaguar","value":3483,"x":"2019-07-31"},{"name":"Jaguar","value":3538,"x":"2019-08-01"},{"name":"Jaguar","value":2805,"x":"2019-08-02"},{"name":"Jaguar","value":2501,"x":"2019-08-03"},{"name":"Jaguar","value":2171,"x":"2019-08-04"},{"name":"Jaguar","value":2688,"x":"2019-08-05"},{"name":"Jaguar","value":2543,"x":"2019-08-06"},{"name":"Jaguar","value":2515,"x":"2019-08-07"},{"name":"Jaguar","value":2783,"x":"2019-08-08"},{"name":"Jaguar","value":2327,"x":"2019-08-09"},{"name":"Jaguar","value":2223,"x":"2019-08-10"},{"name":"Jaguar","value":2040,"x":"2019-08-11"},{"name":"Jaguar","value":2802,"x":"2019-08-12"},{"name":"Jaguar","value":3470,"x":"2019-08-13"},{"name":"Jaguar","value":3639,"x":"2019-08-14"},{"name":"Jaguar","value":3820,"x":"2019-08-15"},{"name":"Jaguar","value":3463,"x":"2019-08-16"},{"name":"Jaguar","value":6682,"x":"2019-08-17"},{"name":"Jaguar","value":2624,"x":"2019-08-18"},{"name":"Jaguar","value":3423,"x":"2019-08-19"},{"name":"Jaguar","value":3334,"x":"2019-08-20"},{"name":"Jaguar","value":3139,"x":"2019-08-21"},{"name":"Jaguar","value":3350,"x":"2019-08-22"},{"name":"Jaguar","value":3713,"x":"2019-08-23"},{"name":"Jaguar","value":2747,"x":"2019-08-24"},{"name":"Jaguar","value":3468,"x":"2019-08-25"},{"name":"Jaguar","value":3350,"x":"2019-08-26"},{"name":"Jaguar","value":3301,"x":"2019-08-27"},{"name":"Jaguar","value":2751,"x":"2019-08-28"},{"name":"Jaguar","value":3187,"x":"2019-08-29"},{"name":"Land Rover","value":10887,"x":"2019-07-29"},{"name":"Land Rover","value":11003,"x":"2019-07-30"},{"name":"Land Rover","value":15649,"x":"2019-07-31"},{"name":"Land Rover","value":15200,"x":"2019-08-01"},{"name":"Land Rover","value":12468,"x":"2019-08-02"},{"name":"Land Rover","value":11435,"x":"2019-08-03"},{"name":"Land Rover","value":10473,"x":"2019-08-04"},{"name":"Land Rover","value":8365,"x":"2019-08-05"},{"name":"Land Rover","value":8059,"x":"2019-08-06"},{"name":"Land Rover","value":8509,"x":"2019-08-07"},{"name":"Land Rover","value":9356,"x":"2019-08-08"},{"name":"Land Rover","value":9998,"x":"2019-08-09"},{"name":"Land Rover","value":7786,"x":"2019-08-10"},{"name":"Land Rover","value":7324,"x":"2019-08-11"},{"name":"Land Rover","value":9281,"x":"2019-08-12"},{"name":"Land Rover","value":10269,"x":"2019-08-13"},{"name":"Land Rover","value":10045,"x":"2019-08-14"},{"name":"Land Rover","value":10944,"x":"2019-08-15"},{"name":"Land Rover","value":8778,"x":"2019-08-16"},{"name":"Land Rover","value":7639,"x":"2019-08-17"},{"name":"Land Rover","value":7299,"x":"2019-08-18"},{"name":"Land Rover","value":9094,"x":"2019-08-19"},{"name":"Land Rover","value":9863,"x":"2019-08-20"},{"name":"Land Rover","value":8737,"x":"2019-08-21"},{"name":"Land Rover","value":8716,"x":"2019-08-22"},{"name":"Land Rover","value":9484,"x":"2019-08-23"},{"name":"Land Rover","value":7995,"x":"2019-08-24"},{"name":"Land Rover","value":7925,"x":"2019-08-25"},{"name":"Land Rover","value":10690,"x":"2019-08-26"},{"name":"Land Rover","value":8593,"x":"2019-08-27"},{"name":"Land Rover","value":10468,"x":"2019-08-28"},{"name":"Land Rover","value":9027,"x":"2019-08-29"},{"name":"MB","value":26188,"x":"2019-07-29"},{"name":"MB","value":23770,"x":"2019-07-30"},{"name":"MB","value":23720,"x":"2019-07-31"},{"name":"MB","value":22970,"x":"2019-08-01"},{"name":"MB","value":22826,"x":"2019-08-02"},{"name":"MB","value":19888,"x":"2019-08-03"},{"name":"MB","value":19293,"x":"2019-08-04"},{"name":"MB","value":22100,"x":"2019-08-05"},{"name":"MB","value":21520,"x":"2019-08-06"},{"name":"MB","value":20757,"x":"2019-08-07"},{"name":"MB","value":22835,"x":"2019-08-08"},{"name":"MB","value":21498,"x":"2019-08-09"},{"name":"MB","value":23185,"x":"2019-08-10"},{"name":"MB","value":20010,"x":"2019-08-11"},{"name":"MB","value":24209,"x":"2019-08-12"},{"name":"MB","value":26735,"x":"2019-08-13"},{"name":"MB","value":26075,"x":"2019-08-14"},{"name":"MB","value":26078,"x":"2019-08-15"},{"name":"MB","value":22920,"x":"2019-08-16"},{"name":"MB","value":20100,"x":"2019-08-17"},{"name":"MB","value":20586,"x":"2019-08-18"},{"name":"MB","value":31443,"x":"2019-08-19"},{"name":"MB","value":29844,"x":"2019-08-20"},{"name":"MB","value":28916,"x":"2019-08-21"},{"name":"MB","value":28139,"x":"2019-08-22"},{"name":"MB","value":27052,"x":"2019-08-23"},{"name":"MB","value":27399,"x":"2019-08-24"},{"name":"MB","value":30206,"x":"2019-08-25"},{"name":"MB","value":39616,"x":"2019-08-26"},{"name":"MB","value":39686,"x":"2019-08-27"},{"name":"MB","value":37728,"x":"2019-08-28"},{"name":"MB","value":33294,"x":"2019-08-29"}]
var g = _origin.reduce((total,cur)=>{
    if(total[cur.name]){
        total[cur.name].push(cur);
    }else{
        total[cur.name] = [cur];
    }
    return total;
},{});
var origin = [];
var split = 30;
for(let n in g){
    g[n].sort((a,b)=>{
        if(a.x>b.x){
            return 1;
        }
        return -1;
    });
    origin.push(g[n][0]);
    g[n].reduce((pre,cur)=>{
        var gap = cur.value - pre.value;
        var egap = Math.floor(gap/split);
        if(Math.abs(egap) >= 1){
            for(let i=1;i<split;i++){
                origin.push({...pre,value:pre.value+egap*i,x:pre.x+"-"+i});
            }
        }
        origin.push(cur);
        return cur
    });
}

var rankMap = origin.reduce((total,cur)=>{
    if(total[cur.x]){
        total[cur.x].push(cur);
    }else{
        total[cur.x] = [cur];
    }
    return total;
},{});

var rank = [];

for(let key in rankMap){
    const map = {};
    map['category'] = key;
    map['data'] = rankMap[key];
    rank.push(map);
}

//var rank = [{"category":"2019-07-29","data":[{"name":"Audi","value":24748,"x":"2019-07-29"},{"name":"BMW","value":37906,"x":"2019-07-29"},{"name":"Infiniti","value":2312,"x":"2019-07-29"},{"name":"Jaguar","value":3517,"x":"2019-07-29"},{"name":"Land Rover","value":10887,"x":"2019-07-29"},{"name":"MB","value":26188,"x":"2019-07-29"}]},{"category":"2019-07-30","data":[{"name":"Audi","value":25372,"x":"2019-07-30"},{"name":"BMW","value":42483,"x":"2019-07-30"},{"name":"Infiniti","value":2557,"x":"2019-07-30"},{"name":"Jaguar","value":2950,"x":"2019-07-30"},{"name":"Land Rover","value":11003,"x":"2019-07-30"},{"name":"MB","value":23770,"x":"2019-07-30"}]},{"category":"2019-07-31","data":[{"name":"Audi","value":28262,"x":"2019-07-31"},{"name":"BMW","value":39601,"x":"2019-07-31"},{"name":"Infiniti","value":2971,"x":"2019-07-31"},{"name":"Jaguar","value":3483,"x":"2019-07-31"},{"name":"Land Rover","value":15649,"x":"2019-07-31"},{"name":"MB","value":23720,"x":"2019-07-31"}]},{"category":"2019-08-01","data":[{"name":"Audi","value":24909,"x":"2019-08-01"},{"name":"BMW","value":37549,"x":"2019-08-01"},{"name":"Infiniti","value":2848,"x":"2019-08-01"},{"name":"Jaguar","value":3538,"x":"2019-08-01"},{"name":"Land Rover","value":15200,"x":"2019-08-01"},{"name":"MB","value":22970,"x":"2019-08-01"}]},{"category":"2019-08-02","data":[{"name":"Audi","value":21716,"x":"2019-08-02"},{"name":"BMW","value":36870,"x":"2019-08-02"},{"name":"Infiniti","value":2812,"x":"2019-08-02"},{"name":"Jaguar","value":2805,"x":"2019-08-02"},{"name":"Land Rover","value":12468,"x":"2019-08-02"},{"name":"MB","value":22826,"x":"2019-08-02"}]},{"category":"2019-08-03","data":[{"name":"Audi","value":19822,"x":"2019-08-03"},{"name":"BMW","value":32245,"x":"2019-08-03"},{"name":"Infiniti","value":2093,"x":"2019-08-03"},{"name":"Jaguar","value":2501,"x":"2019-08-03"},{"name":"Land Rover","value":11435,"x":"2019-08-03"},{"name":"MB","value":19888,"x":"2019-08-03"}]},{"category":"2019-08-04","data":[{"name":"Audi","value":19214,"x":"2019-08-04"},{"name":"BMW","value":31585,"x":"2019-08-04"},{"name":"Infiniti","value":2359,"x":"2019-08-04"},{"name":"Jaguar","value":2171,"x":"2019-08-04"},{"name":"Land Rover","value":10473,"x":"2019-08-04"},{"name":"MB","value":19293,"x":"2019-08-04"}]},{"category":"2019-08-05","data":[{"name":"Audi","value":21484,"x":"2019-08-05"},{"name":"BMW","value":40358,"x":"2019-08-05"},{"name":"Infiniti","value":4132,"x":"2019-08-05"},{"name":"Jaguar","value":2688,"x":"2019-08-05"},{"name":"Land Rover","value":8365,"x":"2019-08-05"},{"name":"MB","value":22100,"x":"2019-08-05"}]},{"category":"2019-08-06","data":[{"name":"Audi","value":21472,"x":"2019-08-06"},{"name":"BMW","value":63023,"x":"2019-08-06"},{"name":"Infiniti","value":4670,"x":"2019-08-06"},{"name":"Jaguar","value":2543,"x":"2019-08-06"},{"name":"Land Rover","value":8059,"x":"2019-08-06"},{"name":"MB","value":21520,"x":"2019-08-06"}]},{"category":"2019-08-07","data":[{"name":"Audi","value":21628,"x":"2019-08-07"},{"name":"BMW","value":35006,"x":"2019-08-07"},{"name":"Infiniti","value":3046,"x":"2019-08-07"},{"name":"Jaguar","value":2515,"x":"2019-08-07"},{"name":"Land Rover","value":8509,"x":"2019-08-07"},{"name":"MB","value":20757,"x":"2019-08-07"}]},{"category":"2019-08-08","data":[{"name":"Audi","value":21912,"x":"2019-08-08"},{"name":"BMW","value":34769,"x":"2019-08-08"},{"name":"Infiniti","value":3646,"x":"2019-08-08"},{"name":"Jaguar","value":2783,"x":"2019-08-08"},{"name":"Land Rover","value":9356,"x":"2019-08-08"},{"name":"MB","value":22835,"x":"2019-08-08"}]},{"category":"2019-08-09","data":[{"name":"Audi","value":24198,"x":"2019-08-09"},{"name":"BMW","value":35280,"x":"2019-08-09"},{"name":"Infiniti","value":2633,"x":"2019-08-09"},{"name":"Jaguar","value":2327,"x":"2019-08-09"},{"name":"Land Rover","value":9998,"x":"2019-08-09"},{"name":"MB","value":21498,"x":"2019-08-09"}]},{"category":"2019-08-10","data":[{"name":"Audi","value":20488,"x":"2019-08-10"},{"name":"BMW","value":31824,"x":"2019-08-10"},{"name":"Infiniti","value":1917,"x":"2019-08-10"},{"name":"Jaguar","value":2223,"x":"2019-08-10"},{"name":"Land Rover","value":7786,"x":"2019-08-10"},{"name":"MB","value":23185,"x":"2019-08-10"}]},{"category":"2019-08-11","data":[{"name":"Audi","value":20066,"x":"2019-08-11"},{"name":"BMW","value":31123,"x":"2019-08-11"},{"name":"Infiniti","value":1731,"x":"2019-08-11"},{"name":"Jaguar","value":2040,"x":"2019-08-11"},{"name":"Land Rover","value":7324,"x":"2019-08-11"},{"name":"MB","value":20010,"x":"2019-08-11"}]},{"category":"2019-08-12","data":[{"name":"Audi","value":23413,"x":"2019-08-12"},{"name":"BMW","value":37532,"x":"2019-08-12"},{"name":"Infiniti","value":3304,"x":"2019-08-12"},{"name":"Jaguar","value":2802,"x":"2019-08-12"},{"name":"Land Rover","value":9281,"x":"2019-08-12"},{"name":"MB","value":24209,"x":"2019-08-12"}]},{"category":"2019-08-13","data":[{"name":"Audi","value":25832,"x":"2019-08-13"},{"name":"BMW","value":40573,"x":"2019-08-13"},{"name":"Infiniti","value":2894,"x":"2019-08-13"},{"name":"Jaguar","value":3470,"x":"2019-08-13"},{"name":"Land Rover","value":10269,"x":"2019-08-13"},{"name":"MB","value":26735,"x":"2019-08-13"}]},{"category":"2019-08-14","data":[{"name":"Audi","value":27265,"x":"2019-08-14"},{"name":"BMW","value":41860,"x":"2019-08-14"},{"name":"Infiniti","value":4447,"x":"2019-08-14"},{"name":"Jaguar","value":3639,"x":"2019-08-14"},{"name":"Land Rover","value":10045,"x":"2019-08-14"},{"name":"MB","value":26075,"x":"2019-08-14"}]},{"category":"2019-08-15","data":[{"name":"Audi","value":24554,"x":"2019-08-15"},{"name":"BMW","value":39409,"x":"2019-08-15"},{"name":"Infiniti","value":4288,"x":"2019-08-15"},{"name":"Jaguar","value":3820,"x":"2019-08-15"},{"name":"Land Rover","value":10944,"x":"2019-08-15"},{"name":"MB","value":26078,"x":"2019-08-15"}]},{"category":"2019-08-16","data":[{"name":"Audi","value":24223,"x":"2019-08-16"},{"name":"BMW","value":35495,"x":"2019-08-16"},{"name":"Infiniti","value":2906,"x":"2019-08-16"},{"name":"Jaguar","value":3463,"x":"2019-08-16"},{"name":"Land Rover","value":8778,"x":"2019-08-16"},{"name":"MB","value":22920,"x":"2019-08-16"}]},{"category":"2019-08-17","data":[{"name":"Audi","value":22111,"x":"2019-08-17"},{"name":"BMW","value":31724,"x":"2019-08-17"},{"name":"Infiniti","value":2676,"x":"2019-08-17"},{"name":"Jaguar","value":6682,"x":"2019-08-17"},{"name":"Land Rover","value":7639,"x":"2019-08-17"},{"name":"MB","value":20100,"x":"2019-08-17"}]},{"category":"2019-08-18","data":[{"name":"Audi","value":21560,"x":"2019-08-18"},{"name":"BMW","value":31598,"x":"2019-08-18"},{"name":"Infiniti","value":3038,"x":"2019-08-18"},{"name":"Jaguar","value":2624,"x":"2019-08-18"},{"name":"Land Rover","value":7299,"x":"2019-08-18"},{"name":"MB","value":20586,"x":"2019-08-18"}]},{"category":"2019-08-19","data":[{"name":"Audi","value":34278,"x":"2019-08-19"},{"name":"BMW","value":43737,"x":"2019-08-19"},{"name":"Infiniti","value":5015,"x":"2019-08-19"},{"name":"Jaguar","value":3423,"x":"2019-08-19"},{"name":"Land Rover","value":9094,"x":"2019-08-19"},{"name":"MB","value":31443,"x":"2019-08-19"}]},{"category":"2019-08-20","data":[{"name":"Audi","value":34710,"x":"2019-08-20"},{"name":"BMW","value":45367,"x":"2019-08-20"},{"name":"Infiniti","value":4300,"x":"2019-08-20"},{"name":"Jaguar","value":3334,"x":"2019-08-20"},{"name":"Land Rover","value":9863,"x":"2019-08-20"},{"name":"MB","value":29844,"x":"2019-08-20"}]},{"category":"2019-08-21","data":[{"name":"Audi","value":37187,"x":"2019-08-21"},{"name":"BMW","value":42111,"x":"2019-08-21"},{"name":"Infiniti","value":3425,"x":"2019-08-21"},{"name":"Jaguar","value":3139,"x":"2019-08-21"},{"name":"Land Rover","value":8737,"x":"2019-08-21"},{"name":"MB","value":28916,"x":"2019-08-21"}]},{"category":"2019-08-22","data":[{"name":"Audi","value":28606,"x":"2019-08-22"},{"name":"BMW","value":41933,"x":"2019-08-22"},{"name":"Infiniti","value":3317,"x":"2019-08-22"},{"name":"Jaguar","value":3350,"x":"2019-08-22"},{"name":"Land Rover","value":8716,"x":"2019-08-22"},{"name":"MB","value":28139,"x":"2019-08-22"}]},{"category":"2019-08-23","data":[{"name":"Audi","value":29849,"x":"2019-08-23"},{"name":"BMW","value":40739,"x":"2019-08-23"},{"name":"Infiniti","value":3379,"x":"2019-08-23"},{"name":"Jaguar","value":3713,"x":"2019-08-23"},{"name":"Land Rover","value":9484,"x":"2019-08-23"},{"name":"MB","value":27052,"x":"2019-08-23"}]},{"category":"2019-08-24","data":[{"name":"Audi","value":25503,"x":"2019-08-24"},{"name":"BMW","value":39508,"x":"2019-08-24"},{"name":"Infiniti","value":4086,"x":"2019-08-24"},{"name":"Jaguar","value":2747,"x":"2019-08-24"},{"name":"Land Rover","value":7995,"x":"2019-08-24"},{"name":"MB","value":27399,"x":"2019-08-24"}]},{"category":"2019-08-25","data":[{"name":"Audi","value":26128,"x":"2019-08-25"},{"name":"BMW","value":39255,"x":"2019-08-25"},{"name":"Infiniti","value":2359,"x":"2019-08-25"},{"name":"Jaguar","value":3468,"x":"2019-08-25"},{"name":"Land Rover","value":7925,"x":"2019-08-25"},{"name":"MB","value":30206,"x":"2019-08-25"}]},{"category":"2019-08-26","data":[{"name":"Audi","value":77896,"x":"2019-08-26"},{"name":"BMW","value":43263,"x":"2019-08-26"},{"name":"Infiniti","value":3879,"x":"2019-08-26"},{"name":"Jaguar","value":3350,"x":"2019-08-26"},{"name":"Land Rover","value":10690,"x":"2019-08-26"},{"name":"MB","value":39616,"x":"2019-08-26"}]},{"category":"2019-08-27","data":[{"name":"Audi","value":71553,"x":"2019-08-27"},{"name":"BMW","value":45463,"x":"2019-08-27"},{"name":"Infiniti","value":3694,"x":"2019-08-27"},{"name":"Jaguar","value":3301,"x":"2019-08-27"},{"name":"Land Rover","value":8593,"x":"2019-08-27"},{"name":"MB","value":39686,"x":"2019-08-27"}]},{"category":"2019-08-28","data":[{"name":"Audi","value":48260,"x":"2019-08-28"},{"name":"BMW","value":46212,"x":"2019-08-28"},{"name":"Infiniti","value":3430,"x":"2019-08-28"},{"name":"Jaguar","value":2751,"x":"2019-08-28"},{"name":"Land Rover","value":10468,"x":"2019-08-28"},{"name":"MB","value":37728,"x":"2019-08-28"}]},{"category":"2019-08-29","data":[{"name":"Audi","value":50882,"x":"2019-08-29"},{"name":"BMW","value":45891,"x":"2019-08-29"},{"name":"Infiniti","value":3705,"x":"2019-08-29"},{"name":"Jaguar","value":3187,"x":"2019-08-29"},{"name":"Land Rover","value":9027,"x":"2019-08-29"},{"name":"MB","value":33294,"x":"2019-08-29"}]}]
var colors = [
    '#187fc5',
    '#0bbfff',
    '#8fd9f3',
    '#628dab',
    '#b4c8d6',
    '#d3e5f2',
    '#84b2de',
    '#6ea0cf',
    '#558abc',
    '#3a76af',
    '#2a639a',
    '#0b4a87',
    '#00274d',
    '#aad2dc',
    '#83bac8',
    '#5694a4',
    '#2c7487',
    '#0b4d5f',
    '#003442',
    '#042129'
];
var colorMap = ['BMW','Audi','MB','Land Rover','Infiniti','Jaguar'].reduce((map,cur,idx)=>{
    map[cur] = colors[idx];
    return map;
},{});

unit = {
    '0': '',
    '1': '万',
    '2': '亿',
    '3': '兆'
};
function formatNum(strNum) {
    if (Math.round(strNum) <= 10 && strNum.length <= 3) {
        return strNum;
    }
    u0 = 0
    while (Math.round(strNum) > 1000000 && u0 < 3) {
        strNum = Math.round(Math.round(strNum) / 10000);
        u0 = u0 + 1
    }

    if (!/^(\+|-)?(\d+)(\.\d+)?$/.test(strNum)) {
        return strNum;
    }
    var a = RegExp.$1,
        b = RegExp.$2,
        c = RegExp.$3;
    var re = new RegExp();
    re.compile("(\\d)(\\d{3})(,|$)");
    while (re.test(b)) {
        b = b.replace(re, "$1,$2$3");
    }
    return a + "" + b + "" + c + unit[String(u0)];
}
var baseOption = {
    animationDurationUpdate: 50 * 1.5,
    animationEasingUpdate: 'quinticInOut',
    title:[
        {
            text: rank[0].category,
            right:'0%',
            bottom: 100,
            textStyle: {
                fontSize: 40,
                color: '#ccc'
            }
        },
        {
            text: 'Total:0',
            right:'0%',
            bottom: 60,
            textStyle: {
                fontSize: 26,
                color: '#ccc',
                fontWeight: 400
            }
        }
    ],
    grid:{
        left: "left",
        right: 20,
        bottom: 50,
        width: "95%",
        containLabel: true
    },
    xAxis:{
        position:'top',
        axisLine: {
            show: false
        },
        axisTick: {
            show: false
        }
    },
    yAxis:{
        type:'category',
        axisTick: {
            show: false
        },
    },
    series:[
         {
            type:'bar',
            barMaxWidth:60
         }
    ],
    timeline:{
        data:rank.map(o=>o.category),
        axisType: 'category', 
        autoPlay: true, 
        playInterval: 200, 
        symbol:'rect',
        symbolSize:[1,4],
        symbolOffset:[0,2],
        left:'left',
        right:20,
        lineStyle:{
            width:1
        },
        controlStyle:{
            showNextBtn:false,
            showPrevBtn:false,
        },
        checkpointStyle: {
            color: '#999',
            borderWidth: 1,
            symbol:'triangle',
            borderColor: 'transparent',
            symbolRotate:180
        },
    }
}
var options = rank.map(o=>{
    return {
        title:[
            {
                text:o.category
            },
            {
                text:'Total:'+formatNum(o.data.reduce((sum,v)=>{
                    sum+=v.value;
                    return sum;
                },0))
            }
        ],
        yAxis:{
            data:o.data.sort((a,b)=>a.value-b.value).map(item=>item.name)
        },
        series:[{
            data:o.data.sort((a,b)=>a.value-b.value),
            label:{
                    show:true,
                    position:'right',
                    formatter:(p)=>{
                        return formatNum(p.value);
                    },
                    color:'#333'
            },
            itemStyle: {
                    color: function(params) {
                        return colorMap[params.name];
                    }
            },
        }]
        // series:o.data.sort((a,b)=>b.value-a.value).map((item,idx)=>{
        //     return {
        //         data:[{...item}],
        //         type:'bar',
        //         name:['Audi'].includes(item.name)?'trs1':'trs2',
        //         label:{
        //                 show:true,
        //                 position:'right',
        //                 formatter:(p)=>{
        //                     return formatNum(p.value);
        //              }
        //     }
        //  }
        // })
    }
});

var option = {
    baseOption,
    options
}
console.log('option',option);